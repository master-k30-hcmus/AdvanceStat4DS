    \hypertarget{ux111ux1ecdc-dux1eef-liux1ec7u-import-data}{%
\subsection{Đọc dữ liệu (Import
data)}\label{ux111ux1ecdc-dux1eef-liux1ec7u-import-data}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}

\PY{k+kn}{import} \PY{n+nn}{requests}
\PY{k+kn}{import} \PY{n+nn}{io}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{url\PYZus{}dataset} \PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{https://raw.githubusercontent.com/master\PYZhy{}k30\PYZhy{}hcmus/AdvanceStat4DS/master/data/student\PYZus{}scores.csv?token=GHSAT0AAAAAABTWH6ZMOUVVXHWSN4CWRC6CYTAHCSQ}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{download} \PY{o}{=} \PY{n}{requests}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{url\PYZus{}dataset}\PY{p}{)}\PY{o}{.}\PY{n}{content}

\PY{c+c1}{\PYZsh{} Reading the downloaded content and turning it into a pandas dataframe}

\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{io}\PY{o}{.}\PY{n}{StringIO}\PY{p}{(}\PY{n}{download}\PY{o}{.}\PY{n}{decode}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    Bộ dữ liệu lấy từ tập dữ liệu về học sinh Bồ Đào Nha và kết quả học tập
của họ trong các môn toán (395 quan sát) từ 2 trường Gabriel Pereira và
Mousinho da Silveira. Bộ dữ liệu gồm có 33 biến, trong đó có 30 biến
giải thích như trường học, giới tính, tuổi tác, thông tin về thói quen
học tập và lối sống của học sinh và chi tiết gia đình. Các biến dự đoán
gồm \(G1, G2, G3\), là số điểm môn Toán tương ứng với 3 học kỳ, và các
biến này có mối tương quan rõ rệt với nhau.

Đầu tiên, ta thực hiện EDA để hiểu mối quan hệ giữa các yếu tố dự đoán
và điểm số, liên quan đến mối liên hệ giữa điểm số và các biến về trường
học, công việc của cha mẹ, mức tiêu thụ rượu, sức khỏe và các mối quan
hệ gia đình.

    \hypertarget{luxe0m-sux1ea1ch-dux1eef-liux1ec7u-data-cleaning}{%
\subsection{Làm sạch dữ liệu (Data
cleaning)}\label{luxe0m-sux1ea1ch-dux1eef-liux1ec7u-data-cleaning}}

    Trong phần này, ta sẽ xem qua mô tả tổng quan của bộ dữ liệu. Bên cạnh
đó, ta sẽ tiến hành tìm và thay thế các giá trị khuyết \texttt{NA}
(missing values) và thay thế chúng (nếu có). Xác định có các điểm ngoại
lai (outlier) hay không?

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   Unnamed: 0 school sex  age address famsize Pstatus  Medu  Fedu     Mjob  \textbackslash{}
0           1     GP   F   18       U     GT3       A     4     4  at\_home
1           2     GP   F   17       U     GT3       T     1     1  at\_home
2           3     GP   F   15       U     LE3       T     1     1  at\_home
3           4     GP   F   15       U     GT3       T     4     2   health
4           5     GP   F   16       U     GT3       T     3     3    other

   {\ldots} famrel freetime goout  Dalc  Walc  health absences  G1    G2  G3
0  {\ldots}      4        3     4     1     1       3        6   5   6.0   6
1  {\ldots}      5        3     3     1     1       3        4   5   NaN   6
2  {\ldots}      4        3     2     2     3       3       10   7   8.0  10
3  {\ldots}      3        2     2     1     1       5        2  15  14.0  15
4  {\ldots}      4        3     2     1     2       5        4   6  10.0  10

[5 rows x 34 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{missing-value}{%
\subsubsection{Missing value}\label{missing-value}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
       Unnamed: 0         age        Medu        Fedu  traveltime   studytime  \textbackslash{}
count  395.000000  395.000000  395.000000  395.000000  395.000000  395.000000
mean   198.000000   16.696203    2.749367    2.521519    1.448101    2.035443
std    114.170924    1.276043    1.094735    1.088201    0.697505    0.839240
min      1.000000   15.000000    0.000000    0.000000    1.000000    1.000000
25\%     99.500000   16.000000    2.000000    2.000000    1.000000    1.000000
50\%    198.000000   17.000000    3.000000    2.000000    1.000000    2.000000
75\%    296.500000   18.000000    4.000000    3.000000    2.000000    2.000000
max    395.000000   22.000000    4.000000    4.000000    4.000000    4.000000

         failures      famrel    freetime       goout        Dalc        Walc  \textbackslash{}
count  395.000000  395.000000  395.000000  395.000000  395.000000  395.000000
mean     0.334177    3.944304    3.235443    3.108861    1.481013    2.291139
std      0.743651    0.896659    0.998862    1.113278    0.890741    1.287897
min      0.000000    1.000000    1.000000    1.000000    1.000000    1.000000
25\%      0.000000    4.000000    3.000000    2.000000    1.000000    1.000000
50\%      0.000000    4.000000    3.000000    3.000000    1.000000    2.000000
75\%      0.000000    5.000000    4.000000    4.000000    2.000000    3.000000
max      3.000000    5.000000    5.000000    5.000000    5.000000    5.000000

           health    absences          G1          G2          G3
count  395.000000  395.000000  395.000000  390.000000  395.000000
mean     3.554430    5.708861   10.908861   10.717949   10.415190
std      1.390303    8.003096    3.319195    3.737868    4.581443
min      1.000000    0.000000    3.000000    0.000000    0.000000
25\%      3.000000    0.000000    8.000000    9.000000    8.000000
50\%      4.000000    4.000000   11.000000   11.000000   11.000000
75\%      5.000000    8.000000   13.000000   13.000000   14.000000
max      5.000000   75.000000   19.000000   19.000000   20.000000
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 395 entries, 0 to 394
Data columns (total 34 columns):
 \#   Column      Non-Null Count  Dtype
---  ------      --------------  -----
 0   Unnamed: 0  395 non-null    int64
 1   school      395 non-null    object
 2   sex         395 non-null    object
 3   age         395 non-null    int64
 4   address     395 non-null    object
 5   famsize     395 non-null    object
 6   Pstatus     395 non-null    object
 7   Medu        395 non-null    int64
 8   Fedu        395 non-null    int64
 9   Mjob        395 non-null    object
 10  Fjob        395 non-null    object
 11  reason      395 non-null    object
 12  guardian    395 non-null    object
 13  traveltime  395 non-null    int64
 14  studytime   395 non-null    int64
 15  failures    395 non-null    int64
 16  schoolsup   395 non-null    object
 17  famsup      395 non-null    object
 18  paid        395 non-null    object
 19  activities  395 non-null    object
 20  nursery     395 non-null    object
 21  higher      395 non-null    object
 22  internet    395 non-null    object
 23  romantic    395 non-null    object
 24  famrel      395 non-null    int64
 25  freetime    395 non-null    int64
 26  goout       395 non-null    int64
 27  Dalc        395 non-null    int64
 28  Walc        395 non-null    int64
 29  health      395 non-null    int64
 30  absences    395 non-null    int64
 31  G1          395 non-null    int64
 32  G2          390 non-null    float64
 33  G3          395 non-null    int64
dtypes: float64(1), int64(16), object(17)
memory usage: 105.0+ KB
    \end{Verbatim}

    Ta có thể thấy được có biến \(G2\) có 5 giá trị \texttt{NULL}. Giá trị
bị thiếu không nhiều nên ra có thể xem xét bỏ hẳn 5 điểm dữ liệu đó ra
khỏi tập dữ liệu của mình

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
       Unnamed: 0         age        Medu        Fedu  traveltime   studytime  \textbackslash{}
count  390.000000  390.000000  390.000000  390.000000  390.000000  390.000000
mean   200.033333   16.705128    2.746154    2.520513    1.453846    2.033333
std    113.369163    1.279751    1.094352    1.089015    0.700109    0.843189
min      1.000000   15.000000    0.000000    0.000000    1.000000    1.000000
25\%    103.250000   16.000000    2.000000    2.000000    1.000000    1.000000
50\%    200.500000   17.000000    3.000000    2.000000    1.000000    2.000000
75\%    297.750000   18.000000    4.000000    3.000000    2.000000    2.000000
max    395.000000   22.000000    4.000000    4.000000    4.000000    4.000000

         failures      famrel    freetime       goout        Dalc        Walc  \textbackslash{}
count  390.000000  390.000000  390.000000  390.000000  390.000000  390.000000
mean     0.338462    3.941026    3.235897    3.110256    1.487179    2.302564
std      0.747443    0.892188    1.001666    1.113436    0.894766    1.290959
min      0.000000    1.000000    1.000000    1.000000    1.000000    1.000000
25\%      0.000000    4.000000    3.000000    2.000000    1.000000    1.000000
50\%      0.000000    4.000000    3.000000    3.000000    1.000000    2.000000
75\%      0.000000    5.000000    4.000000    4.000000    2.000000    3.000000
max      3.000000    5.000000    5.000000    5.000000    5.000000    5.000000

           health    absences          G1          G2          G3
count  390.000000  390.000000  390.000000  390.000000  390.000000
mean     3.561538    5.715385   10.925641   10.717949   10.412821
std      1.390403    8.034215    3.290886    3.737868    4.568962
min      1.000000    0.000000    3.000000    0.000000    0.000000
25\%      3.000000    0.000000    8.000000    9.000000    8.000000
50\%      4.000000    4.000000   11.000000   11.000000   11.000000
75\%      5.000000    8.000000   13.000000   13.000000   13.750000
max      5.000000   75.000000   19.000000   19.000000   20.000000
\end{Verbatim}
\end{tcolorbox}
        
    Ta có thể thấy, sau khi loại bỏ các điểm bị \texttt{NULL} thì kết quả
thống kê sơ bộ của các biến dường như không có sự thay đổi đáng kể. Nên
ta có thể chấp nhận được việc bỏ hoàn toàn 5 điểm dữ liệu bị thiếu.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}check data types}
\PY{n}{df}\PY{o}{.}\PY{n}{dtypes}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Unnamed: 0      int64
school         object
sex            object
age             int64
address        object
famsize        object
Pstatus        object
Medu            int64
Fedu            int64
Mjob           object
Fjob           object
reason         object
guardian       object
traveltime      int64
studytime       int64
failures        int64
schoolsup      object
famsup         object
paid           object
activities     object
nursery        object
higher         object
internet       object
romantic       object
famrel          int64
freetime        int64
goout           int64
Dalc            int64
Walc            int64
health          int64
absences        int64
G1              int64
G2            float64
G3              int64
dtype: object
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{outlier}{%
\subsubsection{2.2 Outlier}\label{outlier}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{col\PYZus{}name} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{col\PYZus{}name}\PY{p}{:}
  \PY{n}{Q1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{,} \PY{n}{interpolation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{midpoint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n}{Q3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{75}\PY{p}{,} \PY{n}{interpolation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{midpoint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
  \PY{n}{IQR} \PY{o}{=} \PY{n}{Q3} \PY{o}{\PYZhy{}} \PY{n}{Q1}

  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Biến: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{col}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Kích thước dữ liệu cũ: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
  \PY{c+c1}{\PYZsh{} Upper bound}
  \PY{n}{upper} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{p}{(}\PY{n}{Q3}\PY{o}{+}\PY{l+m+mf}{1.5}\PY{o}{*}\PY{n}{IQR}\PY{p}{)}\PY{p}{)}
  \PY{c+c1}{\PYZsh{} Lower bound}
  \PY{n}{lower} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{p}{(}\PY{n}{Q1}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.5}\PY{o}{*}\PY{n}{IQR}\PY{p}{)}\PY{p}{)}

  \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{upper}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
  \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{lower}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
  \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Kích thước dữ liệu mới:: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Biến:  age
Kích thước dữ liệu cũ:  (390, 34)
Kích thước dữ liệu mới::  (388, 34)
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913:
SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-
docs/stable/user\_guide/indexing.html\#returning-a-view-versus-a-copy
  errors=errors,
    \end{Verbatim}

    \hypertarget{muxf4-tux1ea3-dux1eef-liux1ec7u-data-visualization}{%
\subsection{Mô tả dữ liệu (Data
visualization)}\label{muxf4-tux1ea3-dux1eef-liux1ec7u-data-visualization}}

    \hypertarget{phuxe2n-tuxedch-biux1ebfn}{%
\subsubsection{Phân tích biến}\label{phuxe2n-tuxedch-biux1ebfn}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{sns}\PY{o}{.}\PY{n}{catplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{age}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{G3}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{kind}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bar}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{data}\PY{o}{=}\PY{n}{df}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<seaborn.axisgrid.FacetGrid at 0x7f0772057610>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_19_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Các độ tuổi đều có điểm trung bình G3 khác nhau, tuy nhiên tuổi \(20\)
lại cao hơn hẳn so với các điểm khác

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{select\PYZus{}dtypes}\PY{p}{(}\PY{n}{include}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{object}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
  \PY{n}{sns}\PY{o}{.}\PY{n}{catplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{col}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{G3}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{kind}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{box}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{data}\PY{o}{=}\PY{n}{df}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_15.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_21_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{itemize}
\tightlist
\item
  Biến \texttt{school}: Ta có thể thấy được phân bố của biến
  \texttt{school} không ảnh hưởng quá nhiều đến kết quả \texttt{G3}, nên
  ta có thể bỏ hoàn toàn biến đó ra khỏi bộ dữ liệu,
\item
  Biến \texttt{sex}: Ta có thể thấy được, những học sinh nam thì có kết
  quả học tập môn toán tốt hơn các bạn nữ nên ta sẽ giữ lại biến này.
\item
  Biến \texttt{address}: Có một sự khác biệt giữ những học sinh học ở
  nông thôn với học sinh ở thành thị, những học sinh học ở nông thôn thì
  có phổ điểm thấp hơn và rộng hơn so với những học sinh ở thành thị.
\item
  Biến \texttt{famsize}: Mặc dú variance của \texttt{GT3} rộng hơn so
  với \texttt{LE3}, tuy nhiên trung bình lại khá bằng nhau, và không có
  sự khác biệt nhiều ảnh hưởng đến kết quả của biến \texttt{G3} nên ta
  sẽ bỏ biến \texttt{famsize}.
\item
  Biến \texttt{Pstatus} cũng tương tự như biến \texttt{famsize} nên ta
  cũng bỏ biến \texttt{Pstatus}.
\item
  Biến \texttt{Medu}: Ta có thể thấy được học thức của người mẹ càng tăng thì trung bình điểm số của các con càng cao
\item
  Biến \texttt{Fedu}: Tương tư như kết quả của người mẹ, tuy nhiên người cha lại không thể hiện mối quan hệ tuyến tính quá rõ ràng như người mẹ
\item
  Biến \texttt{Mjob}: Ta có thể nghề nghiệp của người mẹ thì có thể ảnh
  hưởng trực tiếp đến kết quả của người con, trong khi đó, nghề nghiệp
  của người bố thì lại không ảnh hưởng nhiều đến người con, nên ta sẽ
  điều chỉnh lại biến của người bố gồm 2 thuộc tính là \texttt{teacher}
  và \texttt{other}.
\item
  Biến \texttt{Reason}: không có sự ảnh hưởng nhiều đến kết quả, ta sẽ
  bỏ biến này tuy nhiên cần phải kiểm tra độ tương quan giữa biến
  \texttt{reason} và \texttt{G3}
\item
  Biến \texttt{Graduian}: Ta có thể thấy được là kết quả học tập sẽ giảm
  nếu như người giám hộ là một người khác mà không phải bố mẹ. Điều này
  đồng nghĩa với việc ta sẽ biến đổi biến này thành 2 thuộc tính
  \texttt{both} và \texttt{other}
\item
  Biến \texttt{Traveltime}: Ta có thể thấy các bạn học sinh dành thời
  gian đi chơi nhiều thì sẽ có kết quả học tập thấp hơn.
\item
  Biến \texttt{Sudytime}: Đúng nhưta tưởng tượng thì học sinh dành nhiều
  thời gian học thì sẽ có kết quả học tập tốt hơn, tuy nhiên, nếu học
  sinh dành hơn 5 tiếng học mỗi ngày thì kết quả cũng sẽ không khác
  biệt, nên ta có thể giữ feature này nhưng sẽ nhóm 3 vs 4 làm một nhóm
  chung.
\item
  Biến \texttt{Failures}: Học sinh nào ít rớt hơn thì điểm cao hơn, tuy
  nhiên có sự bất thường ở variance lại lớn nhiều so với 2 nhóm còn lại
  nên ta sẽ cần quan sát kỹ hơn.
\item
  Biến \texttt{schoolsup}: Học sinh nào ít điểm hơn thì rõ ràng cần nhà
  trường hỗ trợ, nên ta sẽ giữ biến này
\item
  Biến \texttt{famsup}: Không có sự khác biệt quá lớn nào giữa học sinh
  có sự hỗ trợ từ gia đình hay không, nên ta sẽ bỏ biến này ra khỏi dữ
  liệu
\item
  Biến \texttt{paid}: Ngạc nhiên là không có sự khác biệt nào đáng kể
  giữa học sinh đi học thêm hay không, nên ta có thể loại bỏ biến này
\item
  Biến \texttt{nursery} \& \texttt{activities}: Dương như không có gì
  ảnh hưởng quá lớn nên ta sẽ bỏ bớt biến này.
\item
  Biến \texttt{higher}: Rõ ràng là những bạn mong muốn được học đại học
  thì kết quả học tập sẽ tốt hơn.
\item
  Biến \texttt{internet}: Ta có thể thấy được việc truy cập internet ảnh
  hưởng rất lớn đến điểm số học sinh nên ta giữ lại biến này.
\item
  Biến \texttt{romantic}: Không có giúp ích được cho mô hình, không có
  sự khác biệt quá lớn nào giữa nhóm có tình yêu hay không, nên ta sẽ bỏ
  biến này.
\item
  Biến \texttt{famrel}: cũng không có sự khác. biệt quá lớn nào nên ta
  cũng sẽ bỏ biến này ra khỏi bộ dữ liệu
\item
  Biến \texttt{freetime}: Feature dường như có nhiều thông tin khác nên
  ta sẽ giữ lại để cân nhắc.
\item
  Biến \texttt{goout}: Dương như có một điểm trade-off giữa thời gian ra
  ngoài và điểm số, dành nhiều thơi gian để đi chơi thì điểm sẽ thấp
  hơn, nhưng ít thời gian hơn thì điểm cũng thấp hơn. Tuy nhiên, thời
  gian vừa đủ thì điểm cao hơn điều này liên quan đến việc dành đủ thời
  gian để tận hưởng và giữ tâm trí thoải mái để học tốt hơn.
\item
  Biến \texttt{Dalc}: Feature này không đưa ra bất kỳ insight nào, nên
  ta sẽ xem xét giữ để quan sát kỹ hơn.
\item
  Biến \texttt{Walc}: Ta có thể thấy phân bố của học sinh tiêu thụ lượng
  cồn ít (1 và 2) tương đối giống nhau và rộng hơn so với phổ điểm của
  bạn học sinh tiêu thụ lượng cồn nhiều (3,4 và 5). Điều này dẫn đến
  việc ta có thể gộp 1 và 2 thành một và 3,4 và 5 làm một.
\item
  Biến \texttt{health}: Ta có thể thấy một điều rất kỳ lạ là các bạn học
  sinh có sức khoẻ thấp thì lại có trung bình \(G3\) cao hơn so với các
  bạn học sinh có sức khoẻ đầy đủ. Điều này ta sẽ giữ biến này lại và sẽ
  gộp 3 và 4 thành một
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absencesband}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{duplicates}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{drop}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absencesband}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[(-0.075, 7.5], (7.5, 15.0], (15.0, 22.5], (22.5, 30.0], (52.5, 60.0], (67.5,
75.0], (37.5, 45.0]]
Categories (10, interval[float64, right]): [(-0.075, 7.5] < (7.5, 15.0] < (15.0,
22.5] <
                                            (22.5, 30.0] {\ldots} (45.0, 52.5] <
(52.5, 60.0] <
                                            (60.0, 67.5] < (67.5, 75.0]]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absencesband}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absencesband}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{as\PYZus{}index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   absencesband   G3
0           282  282
1            73   73
2            22   22
3             6    6
4             0    0
5             2    2
6             0    0
7             2    2
8             0    0
9             1    1
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{15}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{15}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{23}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{23}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]} \PY{o}{=} \PY{l+m+mi}{2}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   Unnamed: 0 school sex  age address famsize Pstatus  Medu  Fedu     Mjob  \textbackslash{}
0           1     GP   F   18       U     GT3       A     4     4  at\_home
2           3     GP   F   15       U     LE3       T     1     1  at\_home
3           4     GP   F   15       U     GT3       T     4     2   health
4           5     GP   F   16       U     GT3       T     3     3    other
6           7     GP   M   16       U     LE3       T     2     2    other

   {\ldots} freetime goout Dalc  Walc  health  absences  G1    G2  G3  \textbackslash{}
0  {\ldots}        3     4    1     1       3         0   5   6.0   6
2  {\ldots}        3     2    2     3       3         0   7   8.0  10
3  {\ldots}        2     2    1     1       5         0  15  14.0  15
4  {\ldots}        3     2    1     2       5         0   6  10.0  10
6  {\ldots}        4     4    1     1       3         0  12  12.0  11

    absencesband
0  (-0.075, 7.5]
2    (7.5, 15.0]
3  (-0.075, 7.5]
4  (-0.075, 7.5]
6  (-0.075, 7.5]

[5 rows x 35 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{as\PYZus{}index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   absences   G3
0       355  355
1        23   23
2        10   10
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{sns}\PY{o}{.}\PY{n}{catplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{absences}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{G3}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{box}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{data}\PY{o}{=}\PY{n}{df}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<seaborn.axisgrid.FacetGrid at 0x7f0771b2de10>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.5\linewidth}{0.5\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_29_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Ta có thể thấy biến \texttt{absences} đã được phân chia thành 3 nhóm khá
khó ràng, từ đó ta có thể thấy được mối liên hệ giữa vắng mặt và điểm
số, học sinh có nhiều buổi vắng mặt thì điểm sẽ thấp hơn so với học sinh
đi học đầy đủ

    Sau khi phân tích qua tất cả các biến, và quyết định bỏ biến, biến đổi
biến thì ta có kết luận sau: * Ta sẽ bỏ các biến \texttt{school},
\texttt{famsize}, \texttt{pStatus}, \texttt{famsup}, \texttt{paid},
\texttt{activities}, \texttt{nursery}, \texttt{romantic},
\texttt{famrel}, \texttt{absences}

    \begin{itemize}
\tightlist
\item
  Age = `15-16'=0; `17'=1; `18'=2; `19'=3; `20'=4; `21'=5; `22'=6
\item
  Medu = `1 \& 3' = 1; `2'=2; `4'=3
\item
  Fedu = `1 \& 3' = 1; `2'=2; `4'=3
\item
  Mjob = `at\_home'= 0; `health'=1; `other, services, teacher'=2
\item
  Fjob = `teacher'= 0; `other, services, health, at\_home'=1
\item
  reason = `course'=0; `other, home, reputation'=1
\item
  guardian = `mother, father'=0; `other=1'
\item
  traveltime = `1'=0; `2,3,4'=1
\item
  studytime = `1'=0; `2'=1; `3,4'=2
\item
  failures = `2,3'=2
\item
  freetime = `1'=0; `2'=1; `3'=2; `4,5'=3
\item
  goout = `1'=0; `2'=1,`3'=2; `4,5'=3
\item
  Dalc = `1'=0; `2,3'=1,`4'=2; `5'=3
\item
  Walc = `1,2'=0; `3,4,5'=1
\item
  health = `1'=0; `2,3,4'=1; `5'=2
\end{itemize}

    \hypertarget{lux1b0ux1ee3c-bux1ecf-biux1ebfn}{%
\subsubsection{Lược bỏ biến}\label{lux1b0ux1ee3c-bux1ecf-biux1ebfn}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{feature\PYZus{}remove} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{school}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{famsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pstatus}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{famsup}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{activities}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nursery}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{romantic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{famrel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absencesband}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{for} \PY{n}{feature} \PY{o+ow}{in} \PY{n}{feature\PYZus{}remove}\PY{p}{:}
  \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{feature}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Index(['sex', 'age', 'address', 'Medu', 'Fedu', 'Mjob', 'Fjob', 'reason',
       'guardian', 'traveltime', 'studytime', 'failures', 'schoolsup',
       'higher', 'internet', 'freetime', 'goout', 'Dalc', 'Walc', 'health',
       'absences', 'G1', 'G2', 'G3'],
      dtype='object')
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{biux1ebfn-ux111ux1ed5i-biux1ebfn}{%
\subsubsection{Biến đổi biến}\label{biux1ebfn-ux111ux1ed5i-biux1ebfn}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{F}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{address}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{address}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{U}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{15}\PY{p}{:}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{:}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{17}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{19}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{22}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fedu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fedu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mjob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mjob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{at\PYZus{}home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{other}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{services}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{teacher}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fjob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fjob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{at\PYZus{}home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{other}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{services}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{teacher}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reason}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reason}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{course}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{home}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{other}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reputation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{guardian}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{guardian}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mother}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{father}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{other}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{traveltime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{traveltime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{studytime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{studytime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{failures}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{failures}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{schoolsup}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{schoolsup}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{no}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{higher}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{higher}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{no}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{internet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{internet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{no}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{freetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{freetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{goout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{goout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dalc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dalc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Walc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Walc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   sex  age  address  Medu  Fedu  Mjob  Fjob  reason  guardian  traveltime  \textbackslash{}
0    1    2        1     1     1     0     1       0         1           1
2    1    4        1     0     0     0     0       1         1           0
3    1    4        1     1     1     2     0       1         1           0
4    1    4        1     0     0     1     0       1         1           0
6    0    4        1     1     1     1     0       1         1           0

   {\ldots}  internet  freetime  goout  Dalc  Walc  health  absences  G1    G2  G3
0  {\ldots}         0         0      0     1     1       0         0   5   6.0   6
2  {\ldots}         1         0      2     0     0       0         0   7   8.0  10
3  {\ldots}         1         2      2     1     1       1         0  15  14.0  15
4  {\ldots}         0         0      2     1     1       1         0   6  10.0  10
6  {\ldots}         1         1      0     1     1       0         0  12  12.0  11

[5 rows x 24 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
              sex         age     address        Medu        Fedu        Mjob  \textbackslash{}
count  388.000000  388.000000  388.000000  388.000000  388.000000  388.000000
mean     0.525773    3.139175    0.775773    0.615979    0.548969    0.940722
std      0.499980    0.981067    0.417611    0.532608    0.508505    0.481268
min      0.000000    0.000000    0.000000    0.000000    0.000000    0.000000
25\%      0.000000    2.000000    1.000000    0.000000    0.000000    1.000000
50\%      1.000000    3.000000    1.000000    1.000000    1.000000    1.000000
75\%      1.000000    4.000000    1.000000    1.000000    1.000000    1.000000
max      1.000000    5.000000    1.000000    3.000000    2.000000    2.000000

             Fjob      reason    guardian  traveltime  {\ldots}    internet  \textbackslash{}
count  388.000000  388.000000  388.000000  388.000000  {\ldots}  388.000000
mean     0.074742    0.639175    0.917526    0.355670  {\ldots}    0.829897
std      0.263315    0.480860    0.275441    0.479334  {\ldots}    0.376208
min      0.000000    0.000000    0.000000    0.000000  {\ldots}    0.000000
25\%      0.000000    0.000000    1.000000    0.000000  {\ldots}    1.000000
50\%      0.000000    1.000000    1.000000    0.000000  {\ldots}    1.000000
75\%      0.000000    1.000000    1.000000    1.000000  {\ldots}    1.000000
max      1.000000    1.000000    1.000000    1.000000  {\ldots}    1.000000

         freetime       goout        Dalc        Walc      health    absences  \textbackslash{}
count  388.000000  388.000000  388.000000  388.000000  388.000000  388.000000
mean     0.713918    0.904639    0.739691    0.590206    0.608247    0.110825
std      0.728250    0.776715    0.439370    0.492431    0.690380    0.387913
min      0.000000    0.000000    0.000000    0.000000    0.000000    0.000000
25\%      0.000000    0.000000    0.000000    0.000000    0.000000    0.000000
50\%      1.000000    1.000000    1.000000    1.000000    0.000000    0.000000
75\%      1.000000    2.000000    1.000000    1.000000    1.000000    0.000000
max      2.000000    2.000000    1.000000    1.000000    2.000000    2.000000

               G1          G2          G3
count  388.000000  388.000000  388.000000
mean    10.948454   10.760309   10.466495
std      3.283727    3.696045    4.518856
min      3.000000    0.000000    0.000000
25\%      8.000000    9.000000    8.750000
50\%     11.000000   11.000000   11.000000
75\%     13.000000   13.000000   14.000000
max     19.000000   19.000000   20.000000

[8 rows x 24 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{distribution}\PY{p}{(}\PY{n}{dataset}\PY{p}{,}\PY{n}{variable}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        dataset: Include DataFrame here}
\PY{l+s+sd}{        variable: Include which column (categorical) in the data frame should be used for colour encoding.}
\PY{l+s+sd}{    }
\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{    Seaborn plot with colour encoding}
\PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
    \PY{n}{g} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{data} \PY{o}{=} \PY{n}{dataset}\PY{p}{,} \PY{n}{hue} \PY{o}{=} \PY{n}{variable}\PY{p}{)}
    \PY{n}{g}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Graph showing distribution between scores and }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{variable}\PY{p}{)}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{20}\PY{p}{)}
    \PY{n}{g}\PY{o}{.}\PY{n}{fig}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{top}\PY{o}{=} \PY{l+m+mf}{0.9}\PY{p}{)}
    \PY{k}{return} \PY{n}{g}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{correlation}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
    \PY{n}{corr} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
    \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
    \PY{n}{colormap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{diverging\PYZus{}palette}\PY{p}{(}\PY{l+m+mi}{150}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,} \PY{n}{as\PYZus{}cmap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{corr}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{colormap}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.2f}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{corr}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{corr}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{;}
    \PY{n}{plt}\PY{o}{.}\PY{n}{yticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{corr}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{corr}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{correlation}\PY{p}{(}\PY{n}{df}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Ta có thể thấy đa số các biến trong dataset đều không có mối tương quan
với nhau nhiều. Tuy nhiên các biến \texttt{G1}, \texttt{G2}, \texttt{G3}
có mối tương quan rất rõ ràng với nhau, điều này cũng rất dễ hiểu vì đây
là các biến chỉ điểm số học tập của học sinh.

Ta các biến giải thích như sau:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{address}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fedu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mjob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fjob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reason}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{guardian}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{traveltime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{studytime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{failures}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{schoolsup}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{higher}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{internet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{freetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{goout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dalc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Walc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{targert} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{xuxe2y-dux1ef1ng-muxf4-huxecnh-tuyux1ebfn-tuxednh}{%
\subsection{Xây dựng mô hình tuyến
tính}\label{xuxe2y-dux1ef1ng-muxf4-huxecnh-tuyux1ebfn-tuxednh}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{features}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{p}{[}\PY{n}{targert}\PY{p}{]}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.30}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
((271, 23), (117, 23), (271, 1), (117, 1))
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{LR} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{n}{fit\PYZus{}intercept}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{model\PYZus{}baseline} \PY{o}{=} \PY{n}{LR}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\PY{n}{y\PYZus{}hat} \PY{o}{=} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x\PYZus{}real} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
\PY{n}{y\PYZus{}real} \PY{o}{=} \PY{n}{x\PYZus{}real}

\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}hat}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}real}\PY{p}{,} \PY{n}{y\PYZus{}real}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Math predictions}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True values}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted values}\PY{l+s+s1}{\PYZsq{}}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The R\PYZca{}2 for the dataset in train is: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The R\PYZca{}2 for the datasets: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
The R\^{}2 for the dataset in train is:  0.837566054634572
The R\^{}2 for the datasets:  0.7864694244323671
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_51_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Ta có thế thấy các điểm dữ liệu có giá trị \(y=0\), tức là \(G3 = 0\).
Điều này có thể do các bạn học sinh bỏ thi hoặc vì 1 lý do nào đó mà
không tham gia thi được nên ta sẽ xem xét cụ thể các giá trị đó như thế
nào

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{grades} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{list\PYZus{}zero} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{grades}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\PY{n}{list\PYZus{}zero}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     G1    G2  G3
128   7   4.0   0
130  12   0.0   0
131   8   0.0   0
134   9   0.0   0
135  11   0.0   0
136  10   0.0   0
137   4   0.0   0
140   7   9.0   0
144   5   0.0   0
146   6   7.0   0
148   7   6.0   0
150   6   5.0   0
153   5   0.0   0
160   7   6.0   0
162   7   0.0   0
168   6   7.0   0
170   6   5.0   0
173   8   7.0   0
221   6   5.0   0
239   7   7.0   0
244   7   0.0   0
259  10   9.0   0
264   9  10.0   0
269   6   0.0   0
296  10   9.0   0
310   9   9.0   0
316   8   8.0   0
332   7   0.0   0
333   8   8.0   0
334  10   9.0   0
337   7   8.0   0
341  10  10.0   0
343   9   8.0   0
367   7   6.0   0
383   6   5.0   0
389   6   5.0   0
\end{Verbatim}
\end{tcolorbox}
        
    Ta có thể nhận thấy được là các bạn học sinh nhận được điểm G2 = 0 thì
cũng nhận được điểm G3 = 0. Điều này có thể các bạn học sinh bỏ học.
Những bạn điểm G3 = 0 nhưng điểm G1, G2 cao thì có thể do các bạn không
tham gia thi được. Do đó ta có thể xem xet những điểm này là outlier và
ta có thể bỏ ra ngoài tập dữ liệu và xây dựng lại mô hình

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{features}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{p}{[}\PY{n}{targert}\PY{p}{]}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.30}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{LR} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{n}{fit\PYZus{}intercept}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{model\PYZus{}baseline} \PY{o}{=} \PY{n}{LR}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\PY{n}{y\PYZus{}hat} \PY{o}{=} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x\PYZus{}real} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
\PY{n}{y\PYZus{}real} \PY{o}{=} \PY{n}{x\PYZus{}real}

\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}hat}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}real}\PY{p}{,} \PY{n}{y\PYZus{}real}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Math predictions}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True values}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted values}\PY{l+s+s1}{\PYZsq{}}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The R\PYZca{}2 for the dataset in train is: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The R\PYZca{}2 for the datasets: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
The R\^{}2 for the dataset in train is:  0.9362244569989935
The R\^{}2 for the datasets:  0.9287046543900842
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_58_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Ta có thể thấy lúc này mô hình ổn định hơn rất nhiều và chỉ số \(R^2\)
cũng cao hơn \(0,15\) trên tập test, và chỉ số \(R^2\) trên cả 2 tập
train và test đều xấp xỉ bằng nhau, chứng tỏ mô hình khá ổn định và hiểu
được dữ liệu khoảng \(92\%\).

    \hypertarget{ux111uxe1nh-giuxe1-muxf4-huxecnh}{%
\subsection{Đánh giá mô hình}\label{ux111uxe1nh-giuxe1-muxf4-huxecnh}}

    Ta xây dựng thêm 1 mô hình khác, cụ thể ở đây là mô hình Logistic
Regression và dùng hệ số R\^{}2 để nhận xét độ hiệu quả của 2 mô hình .
Tuy nhiên để sử dụng mô hình Logistic Regression, ta phải đưa bài toàn
từ bài toán dự báo sang bài toán phân lớp bằng cách điểm \(G3>10\) sẽ
được gán là \texttt{1} (điểm cao) và \(G3 \leq 10\) sẽ được gán là
\texttt{0} (điểm thấp)

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{LogisticRegression}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df\PYZus{}binary} \PY{o}{=} \PY{n}{df}
\PY{n}{df\PYZus{}binary}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}binary}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,}
                                       \PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{17}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{19}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{address}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Medu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fedu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mjob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fjob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reason}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{guardian}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{traveltime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{studytime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{failures}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{schoolsup}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{higher}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{internet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{freetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{goout}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dalc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Walc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{absences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{G2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{X\PYZus{}train\PYZus{}binary}\PY{p}{,} \PY{n}{X\PYZus{}test\PYZus{}binary}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}binary}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}binary} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{df\PYZus{}binary}\PY{p}{[}\PY{n}{features}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}binary}\PY{p}{[}\PY{n}{targert}\PY{p}{]}\PY{p}{,} 
                                                                                \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.30}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{LR\PYZus{}binary} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{fit\PYZus{}intercept}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{model\PYZus{}LR} \PY{o}{=} \PY{n}{LR\PYZus{}binary}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}binary}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}binary}\PY{p}{)}
\PY{n}{y\PYZus{}hat} \PY{o}{=} \PY{n}{model\PYZus{}LR}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}binary}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:993:
DataConversionWarning: A column-vector y was passed when a 1d array was
expected. Please change the shape of y to (n\_samples, ), for example using
ravel().
  y = column\_or\_1d(y, warn=True)
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{metrics}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{y\PYZus{}hat}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}binary}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{margins}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predict}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Real}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test\PYZus{}binary}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{y\PYZus{}hat}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Real      0   1  All
Predict
0        23   5   28
1         9  69   78
All      32  74  106
              precision    recall  f1-score   support

           0       0.82      0.72      0.77        32
           1       0.88      0.93      0.91        74

    accuracy                           0.87       106
   macro avg       0.85      0.83      0.84       106
weighted avg       0.87      0.87      0.87       106

    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The R\PYZca{}2 for the dataset in train is: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}LR}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}binary}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}binary}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The R\PYZca{}2 for the datasets: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}LR}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}binary}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}binary}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
The R\^{}2 for the dataset in train is:  0.943089430894309
The R\^{}2 for the datasets:  0.8679245283018868
    \end{Verbatim}

    Vậy ta nhận thấy \(R^2\) của model Linear Regression trên tập test đạt
giá trị cao hơn Logistic Regression

    \hypertarget{phuxe2n-tuxedch-thux1eb7ng-dux1b0-residual-analyst}{%
\subsection{Phân tích thặng dư (Residual
Analyst)}\label{phuxe2n-tuxedch-thux1eb7ng-dux1b0-residual-analyst}}

    Ta lựa chọn mô hình Linear Regression để phân tích thặng dư

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{LR} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{n}{fit\PYZus{}intercept}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{model\PYZus{}baseline} \PY{o}{=} \PY{n}{LR}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\PY{n}{y\PYZus{}hat} \PY{o}{=} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x\PYZus{}real} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
\PY{n}{y\PYZus{}real} \PY{o}{=} \PY{n}{x\PYZus{}real}

\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}hat}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}real}\PY{p}{,} \PY{n}{y\PYZus{}real}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Math predictions}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True values}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted values}\PY{l+s+s1}{\PYZsq{}}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The R\PYZca{}2 for the dataset in train is: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The R\PYZca{}2 for the datasets: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
The R\^{}2 for the dataset in train is:  0.9362244569989935
The R\^{}2 for the datasets:  0.9287046543900842
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_72_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{e\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}hat}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{e\PYZus{}y} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{y\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}hat}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{e\PYZus{}y}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{,}\PY{n}{e\PYZus{}y}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.collections.PathCollection at 0x7f0772633350>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{AdvStat4DS_FinalLab_files/AdvStat4DS_FinalLab_74_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Ta nhận thấy các điểm thặng dư nằm quanh trục tung y = 0 và phân bố ngẫu
nhiên

=\textgreater{} Mô hình hồi quy tuyến tính sẽ thích hợp với dữ liệu
trên.

    \hypertarget{cuxe1c-phuxe2n-tuxedch-khuxe1c-vuxe0-kux1ebft-luux1eadn}{%
\subsection{Các phân tích khác và Kết
luận}\label{cuxe1c-phuxe2n-tuxedch-khuxe1c-vuxe0-kux1ebft-luux1eadn}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{n}{model\PYZus{}baseline}\PY{o}{.}\PY{n}{intercept\PYZus{}} \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(array([ 6.95888730e-02, -4.32986789e-02,  2.20051919e-01,  5.10284602e-02,
         7.35743446e-02, -4.97765731e-02, -1.50022550e-01,  6.04698889e-02,
         1.75705945e-01, -3.32406741e-02, -6.58672744e-02,  4.45550401e-02,
         8.67127322e-02, -3.90441405e-02, -1.31425534e-02,  3.86855708e-02,
         1.06273904e-01,  5.34841446e-04,  4.13394834e-02, -8.08513076e-02,
        -2.71139626e-01,  1.06123789e-01,  8.82550123e-01]),
 array([-0.01409606]))
\end{Verbatim}
\end{tcolorbox}
        
    Kiểm định giả thuyết cho hệ số hồi quy

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
\PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k+kn}{import} \PY{n}{ols}

\PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{features}\PY{p}{]}\PY{p}{)}
\PY{n}{est} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{targert}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{)}
\PY{n}{est2} \PY{o}{=} \PY{n}{est}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{est2}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
                            OLS Regression Results
==============================================================================
Dep. Variable:                     G3   R-squared:                       0.495
Model:                            OLS   Adj. R-squared:                  0.459
Method:                 Least Squares   F-statistic:                     13.97
Date:                Mon, 02 May 2022   Prob (F-statistic):           3.33e-36
Time:                        07:10:28   Log-Likelihood:                -85.986
No. Observations:                 352   AIC:                             220.0
Df Residuals:                     328   BIC:                             312.7
Df Model:                          23
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         -0.3415      0.160     -2.136      0.033      -0.656      -0.027
sex            0.0287      0.038      0.749      0.454      -0.047       0.104
age            0.0138      0.022      0.640      0.523      -0.029       0.056
address       -0.0088      0.046     -0.192      0.848      -0.099       0.081
Medu          -0.0354      0.034     -1.028      0.305      -0.103       0.032
Fedu           0.0142      0.036      0.391      0.696      -0.057       0.085
Mjob          -0.0651      0.040     -1.619      0.106      -0.144       0.014
Fjob          -0.0685      0.070     -0.975      0.330      -0.207       0.070
reason         0.0399      0.037      1.071      0.285      -0.033       0.113
guardian       0.0345      0.076      0.454      0.650      -0.115       0.184
traveltime     0.0237      0.038      0.619      0.536      -0.052       0.099
studytime     -0.0217      0.028     -0.783      0.434      -0.076       0.033
failures      -0.0709      0.037     -1.899      0.058      -0.144       0.003
schoolsup      0.0308      0.054      0.566      0.572      -0.076       0.138
higher         0.0281      0.095      0.296      0.768      -0.159       0.215
internet       0.0040      0.050      0.081      0.935      -0.094       0.102
freetime      -0.0003      0.025     -0.012      0.990      -0.050       0.049
goout          0.0440      0.025      1.771      0.077      -0.005       0.093
Dalc          -0.0036      0.046     -0.079      0.937      -0.094       0.087
Walc          -0.0359      0.044     -0.826      0.410      -0.122       0.050
health        -0.0258      0.026     -0.993      0.322      -0.077       0.025
absences      -0.0800      0.045     -1.780      0.076      -0.168       0.008
G1             0.0033      0.013      0.248      0.804      -0.023       0.030
G2             0.0884      0.014      6.413      0.000       0.061       0.116
==============================================================================
Omnibus:                       45.566   Durbin-Watson:                   2.025
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               14.139
Skew:                          -0.186   Prob(JB):                     0.000851
Kurtosis:                       2.091   Cond. No.                         176.
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly
specified.
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/usr/local/lib/python3.7/dist-packages/statsmodels/tsa/tsatools.py:117:
FutureWarning: In a future version of pandas all arguments of concat except for
the argument 'objs' will be keyword-only
  x = pd.concat(x[::order], 1)
    \end{Verbatim}

    =\textgreater{} Ta nhận thấy thật sự chỉ có các biến G1 và G2 ảnh hưởng
lớn đến G3 (pvalue \textless{} 5\%)

    Ta loại 2 biến G1 và G2 ra khỏi nhóm feature, chỉ xét các yếu tố gián
tiếp

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
\PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k+kn}{import} \PY{n}{ols}

\PY{n}{X} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{add\PYZus{}constant}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{features}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{22}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{est} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{OLS}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{targert}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{p}{)}
\PY{n}{est2} \PY{o}{=} \PY{n}{est}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{est2}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
                            OLS Regression Results
==============================================================================
Dep. Variable:                     G3   R-squared:                       0.431
Model:                            OLS   Adj. R-squared:                  0.393
Method:                 Least Squares   F-statistic:                     11.35
Date:                Mon, 02 May 2022   Prob (F-statistic):           6.11e-29
Time:                        07:10:28   Log-Likelihood:                -106.78
No. Observations:                 352   AIC:                             259.6
Df Residuals:                     329   BIC:                             348.4
Df Model:                          22
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         -0.3430      0.169     -2.025      0.044      -0.676      -0.010
sex            0.0293      0.041      0.723      0.470      -0.050       0.109
age            0.0488      0.022      2.205      0.028       0.005       0.092
address        0.0046      0.048      0.095      0.925      -0.091       0.100
Medu          -0.0374      0.036     -1.026      0.306      -0.109       0.034
Fedu           0.0064      0.038      0.168      0.867      -0.069       0.082
Mjob          -0.0465      0.042     -1.095      0.274      -0.130       0.037
Fjob          -0.0503      0.074     -0.677      0.499      -0.197       0.096
reason         0.0357      0.039      0.906      0.366      -0.042       0.113
guardian       0.0300      0.081      0.372      0.710      -0.129       0.189
traveltime     0.0264      0.041      0.651      0.516      -0.053       0.106
studytime     -0.0244      0.029     -0.831      0.406      -0.082       0.033
failures      -0.0661      0.040     -1.672      0.095      -0.144       0.012
schoolsup      0.0484      0.058      0.839      0.402      -0.065       0.162
higher        -0.0048      0.100     -0.048      0.962      -0.202       0.193
internet       0.0407      0.052      0.779      0.437      -0.062       0.144
freetime      -0.0150      0.026     -0.567      0.571      -0.067       0.037
goout          0.0603      0.026      2.302      0.022       0.009       0.112
Dalc          -0.0009      0.049     -0.018      0.985      -0.096       0.095
Walc          -0.0429      0.046     -0.932      0.352      -0.134       0.048
health        -0.0023      0.027     -0.083      0.934      -0.056       0.051
absences      -0.1207      0.047     -2.561      0.011      -0.213      -0.028
G1             0.0789      0.007     11.937      0.000       0.066       0.092
==============================================================================
Omnibus:                       24.678   Durbin-Watson:                   2.042
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               13.754
Skew:                          -0.320   Prob(JB):                      0.00103
Kurtosis:                       2.274   Cond. No.                         129.
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly
specified.
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/usr/local/lib/python3.7/dist-packages/statsmodels/tsa/tsatools.py:117:
FutureWarning: In a future version of pandas all arguments of concat except for
the argument 'objs' will be keyword-only
  x = pd.concat(x[::order], 1)
    \end{Verbatim}

    Ta nhận thấy khi chỉ xét các yếu tố gián tiếp thì các yếu tố có độ ảnh
hưởng cao nhất và có pvalue \textless{} 5\% là \texttt{age} (độ tuổi),
\texttt{goout} (số lần ra ngoài), \texttt{absences} (số buổi vắng mặt)
và biến \texttt{G1}


    % Add a bibliography block to the postdoc